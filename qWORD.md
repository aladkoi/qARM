
# ОГЛАВЛЕНИЕ  Методы класса qWORD

class **%Library.qWORD** extends  

| Methods |
| --- |

• classmethod AFonFind**(qqcnt As ****, qql As ****, qqlang As ****, qviewf As ****, qlistF As ****, qlistFR As ****, qqr0 As ****, Nor As ****)** returns nothing. 

Запуск поиска в фоне (через $Job aFonFind^%ooLibrary.qWORD.1()) 

• classmethod CXML**(Arg1 As ****)** returns  

Преобразование строки для XML. (Замена спец.символов) 

• method CXMLdoc**(str As ****)** returns nothing. 

Вставка тега  вместо $C(13,10) в строку 

• method Cod116 **(Arg1 As ****, Arg2 As ****, Arg3 As ****)** returns nothing. 

Arg2=0 - Преобразовать число Arg1 в число в вистеме счисления по основанию 116 (английские и русские буквы). Arg3 - размер строки числа Arg2=1 - Обратное преобразование 

• method Cod52**(Arg1 As ****, Arg2 As ****, Arg3 As ****)** returns nothing. 

Arg2=0 - Преобразовать число Arg1 в число в вистеме счисления по основанию 52 (английские буквы). Arg3 - размер строки числа Arg2=1 - Обратное преобразование 

• method CodAdd**(****qqpar****1 ****As**** ****, ****Arg****1 ****As**** ****, ****Arg****2 ****As**** ****)** returns nothing. 

функция добавляет +Arg1(+1 по умолчанию) к коду qqpar1.( A-Z,a-z) Arg2=1 - компактный код (задействованы русские буквы) !!!Добавлять можно только небольшое число!!! (см. текст) 

• method CreSortV**(qqw As ****, qqo As ****, Value As ****, qqc0 As ****, SortV As ****, SortVn As ****, New As ****)** returns nothing. 

Создание локального словаря сортировки для понятия qqw объекта qqo Value - выражение для вычисления слова словаря. Не задано - для словаря используется значение понятия qqw qqc0 - текущая общая часть кода экземпляра SortV - индекс словаря (переносится в Vs(qqnump,"SortV") ). По умолчанию - ссылка на текущий перечень релевантных SortVn =1 - НЕ создавать ссылки на экземпляры( переносятся в Vs(qqnump,"SortVn") ). Будут использоваться ссылки словаря понятия qqw !!! для виртуальных объектов ссылки создаются всегда New=1 - обновить словарь. Иначе, если он уже есть, то не строится. Массив локального словаря: ^Qi(qqw,SortV) = кол-во слов ^Qi(qqw,SortV ,значение_слова [,qqo,qqc])=Номер слова в значении Предназначен для вызова в действии по Обработке сортировки (X785). См. qARM.T2ColHButtonDo, qARM.Sort Работает и по ссылочным объектам. В этом случае можно указать и предыдущий объект(первым в qqo через запятую): qqo=предыдущий_","_текущий Создаются правильные Vs(qqnump,"Virt") 

• method FastKey**(qqo As ****, qqwl As ****, qqc As ****, qorder As **** = 1, listz As ****, qqc0 As ****, iobj As ****, iqqc As ****, qqpar4 As ****)** returns nothing. 

Быстрый вариант qW.Key РАБОТАЕТ ТОЛЬКО ДЛЯ НЕПУСТЫХ ЗНАЧЕНИЙ кодируемых понятий (или D*-понятий) Поиск следующего экземпляра объекта qqo для строки кодов понятий qqwl Возвращает код экземпляра или пусто. qorder - направление перемещения (1 или -1 ;0 - проверка наличия - возвращает 0 или 1 а не qqc!!!) qqc0 - общее начало кодов экземпляра listz - список значений понятий (через ~) Если заданы iObj iqqc, то это объект и экземпляр из которых нужно взять значения. listz в этом случае может содержать список кодов замещающих qqwl понятий, если не указан - те же, что и в qqwl. qqpar4 - условие, которому должен удовлетворять найденный код. Можно пользоваться qqo, qqc !!! При наличии R*-понятия для первого из списка qqwl в том же объекте требуется задать qqpar4 вида """ ""_qW.G(qqw0)_"" ""[("" ""_qqz0_"" "")" ( раньше была ошибка "qW.G(qqw0)[qqz0" ) !!!или задать в qqpar4 "NR" 

• method ForTTips**(qqwl As ****, All As ****)** returns nothing. 

Для всплывающих подсказок (понятие X7102) Возвращает спискок в виде строк: имя понятие - значение qqwl - список кодов понятий ( или qqo:qqw) через пробел All=1 - выводить пустые значения Значения понятий вычисляются относительно текущего объекта 

• classmethod G**(qqw As ****)** returns  

Получить значение понятия qqpar1 для текущего qqc экземпляра объекта qqo. 

• method GC**(qqw As ****, qqz As ****)** returns nothing. 

Получить коды значения или значения по списку кодов. Только для кодируемых понятий !!! qqw - код понятия qqz - список кодов через пробел (если qqw начинается на C) или значений 

• method GE**(qqw As ****)** returns nothing. 

Взять значение понятия редактируемого экземпляра объекта. Если значение понятия было отредактировано, то его значение берется из W(qqw), в противном случае - из базы. 

• classmethod GG **(qqoo As ****, qqw As ****, qqcc As ****, fcont As ****)** returns  

Взять значение понятия Arg2 для объекта Arg1 с кодом экземпляра Arg3. Если не задан qqc, то используются текущий контекст (значения qqo,qqc) для определения qqc в рамках текущего поддерева. Если объект выше, то однозначно, ниже - код первого (!!!) экземпляра. fcont - позволяет игнорировать текущий контекст отображения. =0 логическое дерево =qqref - текущая ссылка на объект в физическом дереве. 

• method GH **(qqw As ****, Z As ****)** returns nothing. 

Взять значение характеристики. qqw - код понятия характеристики ("H"_[0-9]_кодпонятия) Z - значение понятия. Не задано - текущий экземпляр (аналог qW.G("H"...) ) Значение может состоять из нескольких слов; тогда возвращается несколько характеристик. 

• method GMFileExp **(ListTop As ****, view As ****, Rel As ****, Flview As ****, desobj As ****, ListMas As ****, ExcepObjs As ****, cond As ****)** returns  

• method GMFileImp**(Rel As ****, qqo As ****, qqc As ****, Nbegqqc As ****, cqqc0 As ****, qqcbeg As ****, Xec As ****)** returns  

• classmethod GT**(qqoo As ****, qqw As ****, qqc As ****, nmax As ****, xml As **** = 0, leer As ****, noind As ****)** returns  

Взять текстовое понятие в виде строки с разделителями $C(13,10). nmax - максимальное кол-во строк. Если -1, то возвращается глобальная ссылка на текст. leer - замещающие пустое значение символы (~ - исчезнет ячейка в режиме Вывод пустых) noind - не преобразовывать ведущие пробелы в отступ 

• method GTab**(qqnumpT As ****, ngr As ****, par As ****)** returns nothing. 

Взять параметр текущей закладки qqnumpT - номер окна закладки (не задано - текущее) ngr - номер группы (по умолчанию -0) par - параметр закладки (см. описание закладок). Например, X43 - имя, Thlp - пояснения. 

• method GW**(Arg1 As ****, ZZ As ****)** returns nothing. 

Создание массива W для списка понятий (Arg1) относительно экземпляра текущего объекта (используется qW.GG). Arg1 список через пробел элементов вида: код_пон_для_W,код_об:код_пон Если код_об пропущен, берется текущий Если код_пон пропущен, берется код_пон_для_W Если Arg1="*", то список всех понятий из описания объекта (!!! не текущего отображения). Возвращает список помещенных в W понятий Например, S %1= qW.GW("p1 p2,p3 p4,7:p5") эквивалентно S W("p1")=qW.GG(qqo,"p1"),W("p2")=qW.GG(qqo,"p3"),W("p4")=qW.GG(7,"p5") %1 будет содержать "p1 p2 p4" Если задан ZZ, то значения берутся из него (разделитель ~). Если ввод, добавляется в qqwchg. Для использования в методе qARM.wwww в правиле проверки. 

• method GWlist**(qqol As ****, qqwl As ****, qqcl As ****)** returns nothing. 

Занести в массив W значения списка понятий qqwl (через пробел) для экземпляра qqcl объекта qqol 

• method GZ**(qqoo As ****, qqw As ****, qqwl As ****, zn As ****, ZZ As ****, retqqw As ****, qqc0 As ****)** returns  

Найти значение понятия qqw в объекте qqoo через общие значения списка qqwl (через пробел) значений понятий текущего объекта. Выполняется поиск первого (!!!) подходящего экземпляра объекта. Используется метод qW.Key. zn=0 или отсутствует - значения понятий qqwl берутся из текущего экземпляра (из базы); zn=1 - из массива W; zn=2 - из параметра ZZ. Если несколько понятий, то их значения через ~. refqqw =1 - найденное значение записывается в W(qqw), возвращается код понятия. Если ввод, добавляется в qqwchg. Для использования в методе qARM.wwww в правиле проверки. !!!! Значения массива W для понятий списка qqwl "портятся" (заполняются значениями понятий для поиска). qqc0 - общая часть кода 

• method Get**(qObj As ****, qqw As ****, qObjt As ****, qqct As ****, Val As ****, Cond As ****)** returns nothing. 

Добыча значения понятия qqw объекта qObj из других объектов . Если значение понятия в поддереве - выдается список значений (через $C(13,10) , - для поиск/аналитика - через пробел). Аналогично методу qW.zList. qObjt - код текущего объекта (не задан - qqo) qqct - код экзепляра текущего объекта (не задан - qqc) Учитывается темпоральность. qObj можно задавать в формате qqo_":"_qqw. Параметр qqw в этом случае не нужен. Val - выражение обработки значения (относительно Z- значение qqw) Cond - дополнительное условие для списка значений (относительно qqo и qqc) Можно задать qqo_":"_qqw{Cond}{=Val} Метод выполняется аналогично qW.GG(qqo,qqw), но с учетом темпоральности и виртуальных объектов. 

• method GetLine**(qqc As ****, qqo As ****, qqpar3 As ****, qxml As **** = 0, picRef As ****)** returns  

взять данные для строки объекта ;qqc - код экземпляра ;qqo - код объекта ;qqpar3 - строка вернуть с разделителем $C(31) или (если qxml=1) в виде XML-тегов picRef - глобал, в который записываются картинки (при этом qqdev не учитывается) 

• method GetObjRuls**(ruls As ****, view As ****, Obj As ****, Arg1 As ****)** returns nothing. 

• method GetWoc**(Arg1 As ****, Arg2 As ****)** returns  

Получить значения по их кодам. Arg1 - код понятия Arg2 - код (или коды через пробел) значения 

• method Glob**(Level As ****, Mas As ****)** returns nothing. 

Метод выдает имя массива для объекта типа Массив (%Имя Массива в описании объекта @@qW.Glob(... ) Level - уровень иерархии (не задан - по последней цифре кода объекта) Mas - Имя массива (не задано - берется из Vs(qqnump,"Glob") Метод используется в системном отображении XXXXGlob. 

• method GtoExt**(dtype As ****, value As ****, qqw As ****, Obj As ****, qxml As **** = 0, Arg As ****)** returns  

Преобразование формата хранения во внешнее представление. dtype - тип данных value - значение Arg - дополнительный параметр спец. обработки: Для списка (dtype=3) - Arg=1 - замена подчерка пробелом 

• classmethod Key**(qObj As ****, qqwl As ****, qqc As ****, qqpar4 As ****, qorder As **** = 1, ext As **** = 0, iObj As ****, iqqc As ****, iqqwl As ****, nomas As ****, qqc0 As ****)** returns  

Поиск следующего экземпляра объекта для строки кодов понятий (значения в массиве W). Возвращает код экземпляра или пусто. qqpar4 - выполяемый для найденных метод ( в этом случае проходятся все подходящие значения) qorder - направление перемещения (1 или -1) ext =1 - строгий вариант (значения понятий не должны быть пусты) Если заданы iObj iqqc, то это объект и экземпляр из которых нужно взять значения. iqqwl в этом случае может содержать список кодов замещающих qqwl понятий, если не указан - те же, что и в qqwl. Если iObj="", то iqqwl может содержать список значений (через ~) для понятий из списка qqwl. qqc0 - общее начало кодов экземпляра !!!! Значения массива W для понятий списка qqwl "портятся" (заполняются значениями понятий для поиска). !!!! Если nomas=1 - сохраняются прежними. !!!Если для первого понятия из списка qqwl в объекте qqo есть R*-понятия, то для корректной работы метода это понятие должно быть еще раз включено в список ( например, "pID pID" вместо "pID" если есть R1pID) 

• method Key4**(qObj As ****, qqwl As ****, qqc As ****, qqpar4 As ****, qorder As **** = 1, ext As **** = 0, iObj As ****, iqqc As ****, iqqwl As ****)** returns  

• method KeyNum**(qObj As ****, qqwl As ****, qqc0 As ****)** returns nothing. 

Возвращает кол-во экземпляров объекта для строки кодов понятий содержащих такие же значения, как в массиве W Если задано qqc0 - желаемая общая часть кода экземпляра 

• method MACRO**(Arg1 As ****)** returns nothing. 

!!! ПРИМЕР макрообработки значения по умолчанию редактирования ячейки (X75). Должно начинаться знаком = !!! Метод должен быть перенесен в класс qUSER прикладной системы Обработка макроподстановок для вычисляемых значений по умолчанию. Заменяет переменные на вызов метода (Используется в статусах qMS) 

• method Message**(****Arg****1 ****As**** ****)** returns nothing. 

• method ObjLget**(Obj As ****)** returns nothing. 

Длина кода экземпляра объекта Obj 

• method ObjRefT**(Obj As ****, ObjP As ****, Arg1 As ****)** returns nothing. 

Проверяет, является ли ObjP предком/родителем для Obj. Если Arg1=1 - проверка по общей схеме базы (по CxObj) Возвращает 1 - родитель, -1 - Obj=ObjP, число - поколений для предка Если ObjP не задан, возвращает код объекта-родителя 

• method RefVirt**(qqop As ****, qqo As ****)** returns  

Определяет, есть ли для объекта qqo виртуальные предки (до объекта qqop) 

• method RelWoc**(qqw As ****, qqo As ****, Value As ****, qqc0 As ****, SortV As ****, SortVn As ****)** returns nothing. 

Создать альтернативный словарь для сортировки по перечню релевантных Value - выражение для значения понятия. Позволяет сделать сортировку по вычисляемым значениям. 

• method SQLClose**(Con As ****, Arg2 As ****)** returns nothing. 

Arg2=1-> Закрытие SQL соединения (по умолчанию Arg2=0) Arg2=0->Закрытие ResultSet (требуется если ..NextB не доходит до последней записи) 

• method SQLCloseTcp**(Arg1 As ****)** returns nothing. 

Arg1=1-> Разрыв TCP соединения и выход из Gateway.exe Arg1=2-> Разрыв TCP соединения и перевод Gateway.exe в режим ожидания 

• method SQLCon**(DSN As ****, user As ****, pwd As ****)** returns nothing. 

Открытие ADO соединения 

• method SQLConEx **(Arg1 As ****)** returns  

• method SQLConTcp **(Arg1 As ****)** returns  

Arg1=1 -> полный выход из Gateway.exe Arg1=2 ->разрыв текущего соединения и перевод Gateway.exe в режим ожидания 

• method SQLExec**(Con As ****, SQL As ****)** returns  

Выполнение SQL-запроса SQL - запрос SQL 

• method SQLExecBf**(Con As ****, SQL As ****, mod As **** = 0)** returns  

отложенное выполнение 

• method SQLGB**(Con As ****, Arg2 As ****)** returns nothing. 

Используется при организации обмена информацией с SQL 

• method SQLGetF**(Con As ****, tbl As ****)** returns nothing. 

Получение списка полей таблицы tbl текущего соединения в %qGWF 

• method SQLGetT**(Con As ****)** returns nothing. 

Получение списка таблиц текущего соединения в %qGWT 

• method SQLNextB**(Con As ****, Arg2 As ****, gref As ****)** returns nothing. 

Перемещение SQL курсора на следующую позицию Arg2=0 -> Более быстрое перемещение SQL курсора на следующую позицию при условии, что не было вызовов SQL функций с другим значением парамета Сon gref -> cсылка на формируемый массив, по умолчанию %qGWS(Con) 

• method SQLNextBQ**(Con As ****, Arg2 As ****)** returns nothing. 

Перемещение SQL курсора на следующую позицию Arg2=0 -> Более быстрое перемещение SQL курсора на следующую позицию при условии, что не было вызовов SQL функций с другим значением парамета Сon gref -> cсылка на формируемый массив, по умолчанию %qGWS(Con) 

• method SQLRec() returns  

Используется при организации обмена информацией с SQL 

• method SQLSend**(bf As ****)** returns nothing. 

Используется при организации обмена информацией с SQL 

• method SQLSetActRst**(Con As ****)** returns nothing. 

Устанавливает активным указанный ResultSet. Вызов функции необходим перед выполнением SQLNextB(Con,0) 

• method StreemCnv**(refn As ****, refo As ****, ObjLn As ****, ObjLo As ****)** returns nothing. 

Преобразование потока (НЕ ДОДЕЛАНО) 

• method StreemExp**(ref As ****, qqo As ****, qqc As ****, Rel As ****, cordtu As **** = 0, ext As ****, extdo As ****, Nopar As ****, NoC As ****, desobj As ****)** returns  

Создание массива потока ref - ссылка на массив qqo - код объекта. Если qqo="" сохранять поддеревья вершины отображения qqc qqc - код экземпляра (или qqc_"*" - тогда qqc -общее начало кода) Rel =1 - сохранять по перечню релевантных полные поддеревья (если пуст, всю базу) Rel =2 - сохранять только (!!!) по перечню релевантных cordtu=1 - сохранять дату время пользователь создания/коррекции ext=1 - внешний вызов Set qW=##class(%qWORD).%New() D qW.StreemExp("^QS(1)",153,"",1,1,1) - сохранит поддеревья объекта 153 всей базы. extdo - действие (по Xcute) перед внешним вызовом. Set qW=##class(%qWORD).%New() D qW.StreemExp("^QS(1)","XView","mseAct",1,1,1,"S Vo(qqnump)=""XXXX"" D qSYS.RelView(""XView"",""mseAct"") S Vs(qqnump,""RelNum"")=1") - сохранить описание отображения mseAct и всех его объектов и понятий. S Vo(qqnump)="XXXX" - имитация вызова из проводника В варианте сохранения по отображению (qqo="" ) ПУСТЫЕ ЗНАЧЕНИЯ понятий переносятся в поток. Nopar=1 - не сохранять родителей NoC=1 - не сохранять значение qqс (понятие C) desobj=1 - сохранять понятия по описанию объекта (Список сохраняемых понятий берется из xWoc объекта CxObj). В этом случае сохранятся характеристики и C*-понятия (если они попали в список понятий объекта). В этом варианте ПУСТЫЕ ЗНАЧЕНИЯ понятий переносятся в поток (аналогично сохранению по отображению) =2 - сохранять только имеющиеся в экземпляре (даже если сохранение по отображению). Пустые значения и характеристики НЕ сохраняются. 

• method StreemImp**(ref As ****, Rel As **** = 0, cordtu As **** = 1, Obj As ****, qqc As ****, Nobegqqc As **** = 1, cqqc As **** = 1, qqcbeg As ****, Xec As ****, LineChObj As ****)** returns  

Восстановить массив потока ref - ссылка на массив Rel =1 - записать восстановленные в релевантные qqo, qqc - для частичного восстановления qqo - код восстанавливаемого объекта вершины потока . Если qqo="" - все вершины в потоке qqc - код экземпляра восстанавливаемого объекта Nbegqqc=1 - игнорировать диапазон кодов cqqc=1 - замещать одинаковые коды, 0 - всегда порождать новые qqcbeg - желаемое начало кодов востанавливаемых экземпляров (!!!всех объектов) Восстановленные экземпляры убираются из потока При восстановлении, если есть понятие "C" у экземпляра объекта, то предполагается, что оно содержит желаемый код экземпляра (если cqqc=1) В этом случае анализируется понятие Xch экземпляра. Если 1 - удаление всех потомков. В описание объекта (CxObj - %Объекты) добавлен %Список ключевых понятий потока. Обрабатывается при восстановлении потока для поиска замещаемого потоком экземпляра объекта (вне зависимости от значения понятия С в потоке !!!). !!! Работает вне зависимости от cqqc!!! Если не найден: - берется из понятия С, если такового нет в базе; - или создается новый Xec - действие перед коррекцией экземпляра информацией потока. В действии доступны: qObj - код объекта qqc - код экземпляра Lqqw - список кодов понятий (через пробел) значения которых помещены в W(qqw) В результате действия Lqqw и соответствующие W(qqw) могут быть измены/добавлены. Возможен вызов из постдействия после восстановления файла через gmaneger: S qa=##class(%TqARM).%New(),qARM("Pars",9)="D qW.StreemImp(......) S qqend=1" D qa.Create() !!! В методе использована своя обработка ошибок. Если возникает ошибка при восстановлении потока, временно отключить для отладки обработку ошибок в методе 

• method Translit**(Arg1 As ****)** returns nothing. 

Транслитерация русских больших и маленьких букв Arg1 - строка 

• method UserOrd**(Var1 As ****, Var2 As ****, Var3 As ****, Var4 As ****, Avto As ****, Cond As ****)** returns  

Вычисляет следующий (предыдущий) qqc для объекта с проверкой на общее начало если полученный qqc не подходит, возвращается пусто Var1-направление(1 или -1),Var2-код объекта,Var3-начальный qqc(если "", то берется Var4_$C(255) при Var1=-1),Var4-общее начало Avto=1 - автоматическое определение общего кода по предыдущему объекту текущего отображения. Cond - условие (относительно qqc,qqo) которое должно выполнятся 

• method X74Xcd**(****qqwcd**** ****As**** ****)** returns nothing. 

Специальное правило проверки для редактирования @ZXc и @ZXd qqwcd=Xc или Xd Создатся W(qqwcd) и изменяется qqwchg 

• method gForm**(qql As **** = 1, qqo As **** = """", qqc As **** = """", qqnmax As ****, add As ****, qxml As **** = 0, full As **** = 0, rewr As ****, q6 As ****, xmlRef As ****, picRef As ****)** returns nothing. 

qqnmax - максимально допустимое кол-во обрабатываемых экземпляров объекта qxml=1 - формирование XML (=2 - включит атрибут id=qqc) form - НЕ ИСПОЛЬЗУЕТСЯ В варианте не XML создается массив состояния дерева экземпляров Vc (раньше W("C")). Vc(qqnump) = текущая ORef - локальная объектная ссылка (раньше - W("Zrol",1)) Vc(qqnump,ORef)=OID - qqc Vc(qqnump,ORef,0)=Obj - код объекта Vc(qqnump,Oref,1)=0 - неактивный объект Vc(qqnump,Oref,2)=1 - включен в релевантные Vc(qqnump,Oref,5)=qqtime (дата, время, пользователь последней коррекции) ORef - два символа на уровень иерархии (AA-$C(120,120)) с шагом 5 (для вставок). xmlRef - глобал, в который записывается текст xml (при этом qqdev не учитывается) picRef - глобал, в который записываются картинки (при этом qqdev не учитывается) 

• method gOrder**(qorder As ****, qqo As ****, qqcc As ****, qqcc0 As ****, qsor As ****, find As ****)** returns  

ggcc(qorder,qqo,qqcc,qqcc0) ;,qqz,qqz0) ;qorder=1/-1 следующий/предыдущий код, qorder=0 проверка на существование ;W("Zostr") - объект сортировки ;qqcc - начальный код ;qqcc0 - общая часть кода ;???? ;qqz - начальное значение понятия сортировки ;qqz0 - общая часть понятия сортировки find=1 - вызов из поиска 

• method gOrderSort**(qqwsort As ****, Arg1 As ****, revers As ****)** returns nothing. 

Для использовании в X529 ссылочных объектов. Выполняет сортировку экземпляров по значению понятия qqwsort. Если Arg1=1, то qqwsort вычисляется как выражение. Кол-во экземпляров должно быть небольшим. revers=1 - обратная сортировка 

• method gOrderVsys**(par As ****)** returns nothing. 

• method gRel**(Arg1 As ****, qObj As ****, qqc As ****, Oref As ****, Arg2 As ****)** returns  

Работа с текущим ($$$Relind) перечнем релевантных. Arg1= 0 -очистить + - занести - - удалить qObj - код объекта qqc - код экземпляра Возвращает . через пробел - кол_во экземпляров объекта -0/1 - перечень пуст/нет Oref - используется только для отображений виртуалных объектов Arg2=1 действовать как будто виртуальных нет (для обработки X1191) Arg1="" возвращает $D от перечня релевантных с заданной детализацией (qObj="" - наличие перечня, qqc="" - (!!!)кол-во экземпляров объекта, qqc'="" - экземпляра) 

• method gTempor**(qqo As ****, qqoT As ****, qqoP As ****, qqcP As ****)** returns nothing. 

• method oZ1310() returns nothing. 

• method oZLA() returns nothing. 

Обобщения для подсчета взвешенных значений агрегатов (в % к общему) Используется код понятия вида @ZLA.код_понятия (передается из метода qW.G в переменной qqZN). 

• method oZListOfView() returns  

Возвращает через пробел список отображений, в которых встречается понятие или объект. 

• method oZTMP() returns nothing. 

Обобщение срабатывает при изменении отметки релевантных. Выводит значение по умолчанию для понятия (X75) ZTMP - новая отметка (+ или -) 

• method oZVs8**(qqnump8 As ****, NoReFind As ****, qxml0 As ****)** returns nothing. 

Расшифровка поискового образа для вывода в заголовок отчета (если режим Уточнения). qqnump8 - номер окна с поисковым образом (не задано - текущее) NoReFind=1 - вне зависимости от режима уточнения Возвращает (через ВК ПС ) имена понятий с наложенными на них условиями. Нормализованная дата в простых условиях преобразуется к стандартному виду 

• method oZZdate**(****Arg****1 ****As**** ****, ****Arg****2 ****As**** ****, ****Arg****3 ****As**** ****)** returns nothing. 

W("@ZZdateWeek")=кол-во отображаемых недель 

• method oZZrasp**(Arg1 As ****, tlist As ****, qqwr As ****, tlistDef As ****, listnd As ****, Add As ****, qqoadd As ****, qqwadd As ****, qqc0add As ****, qqwladd As ****, qqwdat As ****, Noqqc As ****)** returns nothing. 

Создание массива расписания на заданный день (Arg1 в формате ГГГГММДД). tlist - строка описания. Если не задана, ищется в W(qqwr) Описание расписания хранится в текстовом понятии W(qqwr) в виде строк. (qqwr="Traspisan" по умолчанию) Формат строк описания - список (через пробел) вида: (1) - тип дня. Пусто - любой; ч - четный день, н - нечетный, п - праздничный, г - нерабочий (праздники и выходные), число (1-7) - день недели; *ГГГГММДД - конкретное число; *ГГГГММДД-ГГГГММДД - число в интервале; *ГГГГММДД- - начиная с конкретного числа к варианту * можно добавлять: #число - периодичность (#1 - каждый день (по умолчанию), #2 - через день и т.п.) Nчисло - кол-во раз Тип дня может быть составным. Например 123, гч (2) - информация о приеме на заднный день (3 и далее) - время и (через ~ ) информация о приеме на заданное время. Примечание: поиск подходящей строки ведется ведется начиная с последней tlistDef - строка описания по умолчанию (если для Arg1 не найдена строка в W(qqwr) ). Если не задана - выходные и праздничные дни - НЕТ_ПРИЕМА, остальные - ПРИЕМ с 9 до 15 с интервалом 30 минут. listnd - список через пробел нерабочих дней в в формате ММДД (по умолчанию - текущие праздники) Add=1 - добавление текущей информации в массив расписания (иначе массив удаляется) Массив расписания имеет вид: W("@ZZrasp",Arg1)=~~информация о приеме на заднный день W("@ZZrasp",Arg1,время)=~~информация о приеме на заднное время Два первых поля (разделитель "~" ) зарезервированы для счетчика и кода экземпляра в отображении работы с графиком W("@ZZrasp",Arg1) при вызове уничтожается. При вызове в виде функции возвращается строка описания расписания для Arg1. Пример описания расписания: W(qqwr,0)= ОБЩЕЕ 9:00 9:30 10:00~ПРОВЕТРИВАНИЕ 10:30 W(qqwr,1)=5 МЕТОДИЧЕСКИЙ_ДЕНЬ 9:00-15:00 W(qqwr,0)=г НЕТ_ПРИЕМА 

• method oZZraspday**(Arg1 As ****, qqwr As ****, tlistDef As ****, listnd As ****, time As ****)** returns nothing. 

Возврат подходящей для заданного дня (Arg1) строки расписания. Параметры см. qW.oZZrasp 

• method oZZraspw**(qqwr As ****, Arg2 As ****)** returns nothing. 

Расшифровка (визуализация) расписания qqwr - код понятия расписания Arg2=1 - выводить только время 

• method oZcordtu**(Arg1 As **** = 3, Arg2 As ****, Arg3 As ****)** returns  

Дата, время,пользователь коррекции и создания текущего экземпляра объекта. Arg1=1 - только коррекция 2 - только создание 3 - обе через ; (вариант по умолчанию) Arg2 - код объекта (по умолчанию qqo) Arg3 - код экземпляра (по умолчанию qqc) 

• method oZdtuco() returns  

• method oZdtucor() returns nothing. 

Дата, время, имя пользователя коррекции 

• method oZdtucr() returns  

Распаковка информации о создании 

• method oZdtudel() returns nothing. 

• method oZnum**(Arg1 As ****)** returns  

Специальное обобщение для счетчиков (иерархических) кол-ва экземпляров для печатных форм. Можно использовать как метод с Arg1 (любое, не совпадающее с кодами объектов) для сквозной нумерации (без учета уровней иерархии) 

• method oZnumBase**(qqoo As ****)** returns nothing. 

Кол-во экземпляров в базе 

• method oZnumRel**(qqoo As ****)** returns nothing. 

Счетчик релевантных 

• method oZrXc() returns nothing. 

Дата создания 

• method oZrXd() returns nothing. 

Дата логического удаления 

• method parent() returns nothing. 

qqnump, qqo, qqw и qqc (через пробел) предыдущего экрана ( "родителя" текущей экранной формы) 

• method qAnal** (qqpar1 As **** = 0, qqpar2 As **** = 0, qqpar3 As ****, por As **** = 0, qanam As ****, all As **** = 0)** returns  

построение аналитического среза по Vs(qqnump,12) qqpar1 - (0) =1 - учет пустых значений qqpar2 - (0) =1 - аналитика по словам значений qqpar3 - =1 - построение иерархии ссылок на экземпляры объектов. Если пуст, то автоматическое определение наличия ссылок для объектов Vs(qqnump,12,qqo)=1. por - (0) - порог экземпляров qanam - имя архива all - (0) =1 - полное дерево 

• method qConv** (qqpar1 As ****, qqpar2 As ****, qqpar3 As ****, qqpar4 As ****, qqpar5 As ****)** returns  

Преобразование строки qqpar1. Убираются лишние пробелы. qqpar2 - другие разделители,qqpar3 - символы, после которых нужен пробел (или другой разделитель. qqpar4'=1 заковыченное соединяется подчерком qqpar5=1 - преобразовать в большие буквы, =2 - в маленькие. 

• method qConvT** (qqo As ****, qqw As ****, qqc As ****, sen As **** = 0, in As ****, qqof As ****, qqwf As ****, teg As ****)** returns  

Раскладка текста на факты. Создаются подчиненные текущему экземпляры объекта с фактами. qqo - код объекта текста qqw - код экземпляра (пока обслуживаются только TB* и T* -понятия) qqc - код экземпляра объекта qqo. Если пуст - обход всех экземпляров. sen=0 - факт - строка;=1 - предложение (до точки с учетом инициалов, чисел) in - список (через пробел) понятий для имен собственных, названий и номеров строк исходного текста, из которого получен факт. Если in="", то используются стандартные коды понятий "Wi Wn Mn". Имена собственные (все, что начинается с большой буквы и не первое слово) и названия (все что в кавычках) добавляются к объекту qqo. Номера строк - к qqof. qqof - код объекта для фактов (подчиненный qqo). Объект должен быть описан (!!!). Длина кода больше длины кода экземпляра qqo (на 1 символ - 52 факта, на 2 - 52**2 и т.п.) qqwf - код понятия фактов (если не задано - берется код "W") teg - если задан, то предполагается, что текст - html. Тогда teg это имя обрамляющего текст тега (например, PRE). Тег задается только именем (без скобок). Лишние теги внутри текста пропускаются. 

• method qFind**(qqmod As **** = 0, qqcnt As ****, qqolst As ****, qA As **** = 0, NoKill As ****, X540 As ****)** returns  

поиск по Vs(qqnump,8,qqo,qqw)=условие qqmod - варант поиска 0 - в перечне релевантных только найденные 1 - полное поддерево объекта вершины поиска qqcnt - мах.количество найденных query - кол-во наборов. Можно не задавать. Оставлено для совместимости. Кол-во наборов возьмется из Vs(qqnump,808) В Vs(qqnump,808) могут находится наборы поисковых образов. Результаты всех наборов объединяются по ИЛИ Vs(qqnump,808)- кол-во наборов Vs(qqnump,808,номер_набора,qqo,qqw)=условие !!!!!Если заданы наборы, то текущий поисковый образ Vs(qqnump,8) должен также находится в одном из наборов NoKill=1 - не удалять перечень релевантных в режиме уточнения. Позволяет добавлять в результирующий перечень релевантных результаты нескольких способов в режиме Уточнения X540=1 - обрабатывать флаг сброса уточнения (пока только для ссылочных/виртуальных объектов) Управляющие переменные: Vs(qqnump, 99, "Find"=0/1 - поиск(отметка) экземпляров/поддерева (для вызова через qARM.Find) Vs(qqnump, 99, "Find", 1) =1 - учитывать одинаковые понятия в разных объектах (для вызова через qARM.Find) Vs(qqnump, 99, "Find", 2) - максимальное количество экземпляров (если не задано - ищутся все) (для вызова через qARM.Find) Vs(qqnump, 99, "Find",5) =1 поиск без учета регистра (Поисковый образ должен быть большими буквами !!!) 

• method qFindA** (cond As ****, addcond As ****, log As ****)** returns nothing. 

Добавление к условию cond выражения addcond через логическую операцию log (&& по умолчанию) 

• method qFindC** (Arg1 As ****, Arg2 As ****, Arg3 As ****)** returns nothing. 

• method qFindList** (Cond As ****, qqmod As ****, query As ****)** returns  

Формирование списка управления поиском 

• method qFindList0() returns nothing. 

• method qFindN**(qqcnt As **** = 0, qql As ****, qqlang As ****, qviewf As ****, qlistF As ****, qlistFR As ****, qqr0 As **** = 0, qNor As **** = 0)** returns  

• method qFindNTest** (qqcnt As **** = 0, qql As ****, qqlang As ****, qviewf As ****, qlistF As ****, qlistFR As ****, qqr0 As **** = 0, qNor As **** = 0)** returns nothing. 

• method qFindNew** (qqmod As **** = 0, qqcnt As ****, qqolst As ****, qA As **** = 0)** returns  

• classmethod qFonFindErr() returns nothing. 

• method qGrabCol** (qqwlst As ****, wwww As ****, qqw As ****, svref As ****)** returns  

Выполняет сборку мусора в прямых словарях понятий. Список понятий определяется параметрами qqwlst и qqw (см. описание параметров). НО вне зависимости от списка понятий, сборка мусора НЕ ВЫПОЛНЯЕТСЯ для следующих типов: - системные понятия; - понятия, у которых значение реквизита "%Сборка мусора" равно "запрещена". Если код понятия начинается на R или C (ссылочные понятия), то системность понятия и "%Сборка мусора" определяется по основному понятию (см. метод). Параметры: qqwlist - список понятий (через пробел), для которых нужно выполнить сборку мусора; wwww - не используется; оставлен для совместимости со старыми версиями; qqw - код понятия, от которого начать сборку мусора для всех нижележащих понятий (обход идет по ^Q(1,CxWoc)); для понятия qqw сборка мусора НЕ ВЫПОЛНЯЕТСЯ; svref - ссылка на массив, в который будут записываться удаленные значения для каждого понятия; если равен "", то запись не ведется Если определен параметр qqw (не равен ""), то значение параметра qqwlist игнорируется. Если qqwlst и qqw равны "", то сборка мусора выполняется для всех понятий. Если сборка мусора выполнялась по qqwlst, то результат работы метода возвращается в виде строки: qqw1: num1/del1 ... qqwN: numN/delN, где qqw1,...,qqwN - код понятия из списка qqwlst; num - число обработанных значений понятия; del - число удаленных значений понятия Если определен svref, то перед записью значений выполняется команда "k @svref". Для каждого понятия, для которого идет сборка мусора, формируются следующие узлы: - @svref@(код_понятия, "num") - число обработанных значений - @svref@(код_понятия, "del") - число удаленных значений - @svref@(код_понятия, "ex",код_значения)=значение - @svref@(код_понятия, "qqwlst")=список ссылочных понятий (на R*) (включая само понятие) - заполняется только в том случае, если x711 ("%Организация словаря") для понятия равна 1. 

• method qObjConv **(qqo As ****, qqonew As ****, Arg1 As ****, Arg2 As ****, Arg3 As ****)** returns  

Преобразование экземпляров объекта qqo. Вызывается из меню Администратор-Преобразование для текущего объекта. Прееобразуются значения понятий по выражениям аналитик. затем rCor. В методе qqc - текущий код, qqo - текущий объект. Измененные значения понятий должны содержаться в W(код_понятия). qqc не должно изменяться в методе. Arg1=1 - преобразование всех объектов отображения Arg1=2 - последовательный проход по всем экземплярам каждого объекта Arg2=1 - не выводить сообщение Arg3=1 - если Arg1=1 - преобразовывать и понятия хранимых объектов 

• method qObjNum**(qqo As ****)** returns  

Подсчет экземпляров объектов в базе или в перечне релевантных. Если qqo="", то всех. 

• method qRef**(qqci As ****)** returns  

Восстановить ссылку W("Zref") по qqci (соответствует W("Zrol",1)). 

• method qWoc**(qqpar1 As ****, qqpar2 As ****, qqpar3 As ****, qqpar4 As ****, qqpar5 As ****, qqpar6 As ****)** returns  

gorw() ; ;qqpar5=1 - заполнять W(qqw),W("C"_qqw) ;qqpar6'="" - заполнять массив @qqpar6 ;qqpar6="Zldrl" - заполнять W("Zldrl"). Вместо пробела - ~ 

• method qWocCnv**(qqwt As ****, qqot As ****, mess As ****)** returns  

Выполняет преобразование словаря понятия в зависимости от свойства x711 ("%Организация словаря"). Параметры: qqwt - код понятия, словарь которого нужно преобразовать; qqot - код объекта, для которого нужно преобразовать словарь понятия; mess - признак вывода сообщений (через qARM.Message()): 0 (по умолчанию) - не выводить, 1 - выводить Если qqot равен "", то преобразование словаря понятия выполняется по всем объектам, которые есть в словаре этого понятия. При преобразовании НЕ выполняется сборка мусора и проверка правильности словаря. 

• method rCodeWoc**(Arg1 As ****, par1 As ****)** returns nothing. 

• method rCopy**(qqo As ****, qqc As ****, qqofrom As ****, qqcfrom As ****, qqwlist As ****, qqmovcor As ****, qqwnoc As ****, nsp As ****)** returns nothing. 

Копирование экземпляров qqo - код объекта qqc - код экземпляра qqofrom - код копируемого объекта qqcfrom - код экземпляра копирумого объекта qqwlist - список кодов копируемых понятий (через пробел). Код может задаваться из двух частей (через запятую) вида qqw,qqwfrom qqwlist="" - копирование всех понятий qqmovcor =1 - копировать даты, время коррекции (только если qqwlist="") qqwnoc - список (через пробел) некопируемых понятий 

• method rCopyTree**(qqo As ****, qqc As ****, qqofrom As ****, qqcfrom As ****, qlist As ****, add As **** = 0, CopyCom As **** = 0, qqwnocone As ****)** returns nothing. 

Копирование поддеревьев (пока только для одного объекта) qqo - код объекта вершины qqc - код экземпляра вершины qqofrom - пока не задействован ( код копируемого объекта (вершины)) qqcfrom - код экземпляра копирумого объекта (вершины) qqwlist - пока не задействован add=0 - заместить, 1 - добавить, -1 - перенести в пустой экземпляр (включая дату,время,пользователь создания,коререкции) Массив W не изменяется CopyCom=1 - копировать связанные с qqo (если qqo - объект документ или объект между объектом-документом и объектом-вершиной) объекты общих сведений qqwnocone - список (через пробел) некопируемых ДЛЯ ВЕРШИНЫ понятий. Для add=1 значения этих понятий не изменятся, в остальных случаях БУДУТ ПУСТЫМИ. 

• method rCor**(qqo As ****, qqc As ****, qqlw As ****, q As **** = 0, cordtu As **** = 1, Hrolog As ****, NoVir As ****, NoW As ****, NoJr As ****)** returns  

Коррекция экземпляра объекта. Сборка мусра в словарях не производится (отложенная) qqlw - список корректируемых понятий (если пуст - удаление экземпляра, если * - очистка - удаление значений всех понятий) q=1 создавать массивы старых значений ( Wo, No) для внутренннего журналирования (пока не используется) cordtu=1 записывать информацию о коррекции (qqtime) если есть обновления (cordtu=2 - всегда) Если qqwl="" - удаление текущего экземпляра. W(qqw) для понятий текущего объекта удаляется (!!!). NoVir=1 - игнорировать виртуальность объекта (используется в преобразовании - метод qW.qObjConv) NoW=1 - не изменять W. Актуально при удалении. NoJr=1 - блокировка журналирования и согласованных изменений 

• method rCorSQL **(qqo As ****, qqwc As ****, qqwcz As ****, qqwl As ****, qqwz As ****)** returns nothing. 

Корректирование/создание записей в SQL-таблицах (виртуальные объекты типа 7) qqo - код виртуального объекта qqwc - код ключевого понятия (в таблице соответствует первичному ключу) qqwcz - значение ключевого понятия qqwl - список обновляемых понятий (через пробел) qqwz - список значений обновляемых понятий (через ~) Если qqwc="" - создание новой записи 

• method rDel (qqo As , qqc As , Rel As  = 0, Ch As  = 0, lqqoch As , qqc0 As , qqcond As , savW As ) returns  

Удаление поддерева экземпляра qqc объекта qqo. Для физического дерева $$$GloRef должна существовать. Если Rel=1, удаление всех экземпляров из перечня релевантных объекта qqo. Ch=1 - удалить только потомков. В этом случае - lqqoch - список (через пробел) кодов объектов удаляемых потомков. Если не задан - удаляются потомки всех объектов из описания объекта qqo (в CxObj).) Возвращает 1 - удален только текущий, 2 - удалялись потомки qqc0 - общая часть удаляемых кодов (в этом случае qqc не учитывается) qqcond - условие, при выполнении которого производится удаление. qqc0 обязан быть задан (хотя бы ""). savW=1 - не изменять W. Иначе удаляются все W(qqw) для qqw из удаляемых экземпляров Метод может вызываться вне контекста окна. Тогда присваивается qqnump="D". ссылки на классы %qWORD и %TqARM (qW, qARM) должны быть. 

• method rDelAll**(qqo As ****, ch As **** = 0, Nogr As ****)** returns nothing. 

Быстрое удаление всех экземпляров объекта и объектов-потомков (если сh=1) Nogr=1 - НЕ собирать мусор в словарях - ускоряет работу 

• method rDelAllView**(Arg1 As ****)** returns nothing. 

Удаление экземпляров всех объектов отображения Arg1 

• method rDelBeg **(qqo As ****, qqc0 As ****, Nogr As ****)** returns nothing. 

Быстрое удаление экземпляров объекта (qqo) на заданное начало (qqc0) Nogr=1 - НЕ собирать мусор в словарях 

• method rDelTree **(qqoH As ****, qqcH As ****, Rel As **** = 0, Ch As **** = 0)** returns  

Удаление поддерева экземпляра qqcH объекта qqoH. Если Rel=1, удаление всех экземпляров из перечня релевантных объекта qqoH. Ch=1 - удалить только потомков Информация о процессе удаления в ^mtempKill($j,"ATime") 

• method rIncM **(qqw As ****, Zadd As ****, qObj As ****, qqct As ****, nominus As ****)** returns nothing. 

Добавить к M* -понятию (!!!) qqw экземпляра объекта qObj с кодом qqct значение Zadd и вернуть полученный результат. Если Zadd не задано - то +1 Если qqct не задано, то вычисляется Если qObj не задано - текущий. !!! Дата/времякоррекции не изменяются nominus=1 не допускать отрицательных значений при ВЫЧИТАНИИ Возвращается: Zadd - если столько можно отнять или сколько можно отнять до 0 

• method rIns** (Arg1 As ****, Arg2 As ****, Nomes As ****, Arg3 As ****)** returns nothing. 

Вставка в объекте Arg1 нового экземпляра после кода Arg2. Возвращает новый код или пусто, если ошибка Nomes=1 - не выдавать сообщений Arg3=1 - вставить перед текущим 

• method rJrn**(mas As ****, all As ****)** returns nothing. 

Восстановление журнала. mas - ссылка на запись в журнале. если число - ^QJ(1,"XJrn",число) all=1 - восстановление всего массива. в этом случае mas - ссылка на массив. 

• method rNew**(Arg1 As ****, Arg2 As ****, Arg3 As ****, Hrolog As ****, NoVir As ****)** returns  

Запись нового экземпляра объекта. функция добавляет +шаг к коду qqpar1. A-z -диапазон цифр кода ------- Arg1 - код объекта. Arg2 - желаемый код экземпляра (можно задавать код объекта предыдущего уровня) Arg3 - шаг кода (если не задан, то проверка отсутствия желаемого) NoVir=1 - игнорировать виртуальность объекта (используется в преобразовании - метод qW.qObjConv) Возвращает новый код и, через пробел, код, к которому добавлен шаг 

• method rNewPr**(qqo As ****, qqc As ****, Num As **** = 1, NoVer As **** = 1, qqwchg As ****, viewpr As ****, HrologPr As ****)** returns  

Недиалоговое порождение поддерева экземпляра объекта. qqo - код объекта qqc - код экземпляра текущего или верхнего уровня. Num - кол-во порождаемых (если пусто, то сколько указано в описании объекта) NoVer=1 - не выполнять проверку перед вводом. Возвращает код порожденного экземпляра (вершины поддерева) или пусто, если не прошла проверка. qqwchg - список (через пробел) кодов вводимых понятий. Соответствующие значения из W в этом случае попадут в первую (!!!) запись. viewpr - отображение ввода. Если задано, то описания типов порождения объектов берутся из него. Если viewpr="XXXsysO" то описание объекта qqo берется из описания структуры базы. HrologPr - желаемые дата, время в формате $Hrolog. Если не заданы - текущие При задании qqc НЕ забывать о возможных отсутствующих уровнях. Необходимо задать именно код физически предыдущего уровня (или любой код текущего).

• method rSort**(qqctop As ****, qqo As ****, qqwsort As ****, qXc As **** = 0, Mas As ****, Beg As ****, order As ****)** returns nothing. 

Пересортировка поддерева экземпляров объекта qqo qqctop - код экземпляра обьекта верхнего уровня qqwsort - код понятия (объекта qqo) по которому делается пересортировка qXc=1 - менять дату коррекции на значение понятия qqwsort (оно обязано быть нормализованной датой). Beg=1 - переместить коды экземпляра "в начало" (относительно qqctop). Если не установлен, коды пересортированных объектов сдвигаются за последний существующий. !!! Beg=2 - убрать все "дырки" !!! ЕСЛИ КОДИРОВКА 52 (только английские) order=-1 обратная сортировка Возвращает: "" - нечего сортировать 0 - все и так в правильном порядке число - номер экземпляра, с которого произведено переупорядочивание Если текущий объект (qqo=$$$CurObj), то текущеее значение qqc изменяется на новое (полученное в результате пересортировки) Метод пригоден для использования в постдействии, например: D:qW.rSort($E(qqc,1,7),174,"pAE",1) qARM.wcre() 

• method rTest**(qqo As ****, qqc As ****)** returns nothing. 

Метод возвращает (через пробел): - признак наличия значений понятий (кроме создания/коррекции); - признак наличия экземпляров объектов-потомков 

• method rTmpVer**(qqo As ****, qqc As ****, qqt As ****)** returns  

Проверка условия темпоральности коррекции (понятие X5280) Возвращает qqo_" "_qqc экземпляра объекта, для которого необходимо выполнить темпоральную коррекцию ; ; Обработка темпоральности перед вводом/коррекцией/удалением (qqt=1/2/3). 

• method rVer**(Arg1 As ****, Arg2 As ****, Arg3 As ****)** returns  

Проверка наличия экземпляра Arg2 объекта Arg1. Используется в правиле проверки понятия C. 

• classmethod rWoc**(qqpar1 As ****)** returns  

• method rWocNew**(Arg1 As ****, Arg2 As ****, Arg3 As ****)** returns  

Запись в словарь Arg1 значения Arg2 с кодом Arg3. Возвращает - 0 -все нормально; 1 - есть значение 2 - есть код 

• method rWocRefLst**(qw As ****)** returns  

Возвращает список (через пробел) ссылочных понятий (на R*) для понятия qw. Первое значение в списке - код понятия qw. 

• method rWocx711** (qw As ****, qo As ****, refr As ****)** returns  

Возвращает значение x711 ("%Организация словаря") понятия qw для объекта qo. Значение x711 определяется следующим образом: - если узел Vx711(qw,qo) не равен "", то возвращается значение этого узла - если ^Q(1,"CxObj",qo,"CxWoc",qw,"x711") не равен "", то возвращается это значение - берется значение +^Q(1,"CxWoc",qw,"x711") Параметры: qw - код понятия qo - код объекта refr - признак обновления; если равен 1, то игнорируется текущее значение Vx711(qw,qo) 

• method rX5247 **(Obj As ****, add As ****, qqcObj As ****)** returns nothing. 

Добавление add к счетчикам групп 

• method rZTMP** (qqot As ****, qqct As ****, qqwt As ****, Zt As ****)** returns nothing. 

Запись (в релевантные) значения ZTMP-понятия qqot - код объекта (не задан - текущий qqo) qqct - код экземпляра объекта (не задан - текущий qqc) qqwt - ZTMP*-понятие (не задано - текущее qqw) Zt - записываемое значение (не задано - текущее Z) Если объекта нет в перечне релевантных, он туда заносится 

• method windos** (Arg1 As ****, Arg2 As ****)** returns  

Перекодировка строки Arg1 из DOS->Win (Arg2)=0 или Win->DOS если Arg2=1 

• method zAge** (Arg1 As **** = $G(Z))** returns  

Вычисление текущего возраста по дате рождения. 

• method zChSym** (str As ****, sym1 As ****, sym2 As ****)** returns nothing. 

замена в строке str подстроки sym1 на подстроку sym2 

• method zCnv** (Arg1 As **** = 0, qqtm As ****, quser As ****)** returns  

Преобразование даты, времени, кода пользователя коррекции. Если Arg1=0 - распаковка. Возврашает дату, время в формате $Hrolog и, через пробел, код пользователя. qqtm - упакованное значение (понятия X или Xc). Если Arg1=1 - упаковка. Возвращает упакованное значение qqtm - дата, время в формате $Hrolog; quser - код пользователя. Для дополнительного преобразования в формат нормализованной даты можно воспользоваться функциями $ZDT($H,8), $ZDTH("ГГГГММДД ЧЧ:ММ:СС",8) 

• method zConvAdr** (n As ****, qqwl As ****, r As ****)** returns nothing. 

Расшифровка (раскладывание на понятия в массиве W) строки адреса !!!Работает пока только для населенных пунков типа ГОРОД n- строка qqwl - список (через пробел) двенадцати понятий адреса ("pCountry pM pN pnmreg pO pnmnp pCc pP pnmul pQ pR pS" - умолчание) 1 (pCountry) - страна; 2 ( pM) - индекс; 3 ( pN) - регион; 4 ( pnmreg) - тип региона 5 ( pO) - населенный пункт 6 ( pnmnp) - тип населенного пункта 7 ( pCc) - район города 8 ( pP) - улица 9 ( pnmul) - тип улицы 10 ( pQ) - дом 11 ( pR) - корпус 12 ( pS) -квартира r - разделитель полей адреса (по умолчанию - запятая) Возвращает qqwl 

• method zDW**(Arg1 As ****, Arg2 As ****)** returns nothing. 

Возвращает день недели. Arg1 - дата в формате $Hrolog (если нормализованная, преобразовать через $ZDH(дата,8)) Arg2=0 (или не задан) - номер дня Arg2=1 - два символа (Пн ...) Arg2=3 - полное название 

• method zDatBE**(date As ****, dateBeg As ****, dateEnd As ****)** returns nothing. 

Проверка даты на диапазон 

• method zDbl** (String As ****, Reg As ****)** returns nothing. 

Возвращает задвоенные символы в строке String в виде этих символов через пробел. Reg=1 - учтиывать регистр Например, qW.zDbl("ААлекксей") вернет "АА KK" qW.zDbl("ААлекксей",1) вернет "АА кк" !!но qW.zDbl("Аалекксей",1) вернет "кк" 

• method zFIO** (Arg1 As ****, Arg2 As ****)** returns nothing. 

Нормализация ФИО (с большой буквы) Arg1 - ФИО (через пробел или подчерк) Arg2=1 - только инициалы Список ФИО (через пробел) обрабатывается. Фамилия, Имя, Отчество должны быть в этом случае через подчерк 

• method zL** (Arg1 As ****)** returns nothing. 

Преобразование имен собственных из больших букв в маленькие. 

• method zList** (Obj As ****, qqwl As ****, Rel As **** = 0, sep As ****, RealObj As ****, seplist As ****, var As ****)** returns  

Список значений понятий для объекта, подчиненного текущему. qqwl - список кодов понятий объекта Obj (через пробел). Rel=1 учет режима уточнения, если есть релевантные sep - разделитель значений возвращаемого списка (для экземпляров). RealObj - если задан, то код реального объекта, относительно которого необходимо выдать список. В этом случае виртуалная структура текущего отображения не учитывается!!! seplist - разделитель значений в списке понятий экземпляра. var=1 - qqwl трактуется как выражение (в нем можно использовать qqo qqc) 

• method zMLine** (mas As ****, num As ****, NoI As ****, I1 As ****)** returns nothing. 

Индексы поддерева в виде списка mas - ссылка на поддерева num - желаемое кол-во. NoI - значение, возвращаемое при отсутствии индексов I1 - если задано, то возвращается при наличии только одного индекса 

• method zNameCase** (SurName As ****, FirstName As ****, PatronymicName As ****, Case As **** = 0, Sex As **** = 0, ReturnSex As ****)** returns nothing. 

Метод преобразуют ФИО заданые в именительном падеже в другой падеж. Параметры: SurName - фамилия FirstName - имя PatronymicName - отчество Case - падеж: 0 - родительный 1 - дательный 2 - винительный 3 - творительный 4 - предложный (по умолчанию Case = 0) Sex - пол: 0 - мужской 1 - жеский Если ReturnSex=1 - возвращает пол (определяется по отчеству) 

• method zNday** (datBeg As ****, datEnd As ****)** returns nothing. 

Кол - во дней для интервала дат форматов ГГГГMMДД, ДД.ММ.ГГГГ, ДД.ММ.ГГ 

• method zNoLeer**(Arg1 As ****)** returns nothing. 

Убрать "малозначащие" пробелы (после цифры, после точки, задвоенные\ведущие\завершающие пробелы 

• method zNum**(Obj As ****, Rel As **** = 0, RealObj As ****)** returns  

Кол-во экземпляров объекта Arg1 подчиненных текущему. Rel=1 учет режима уточнения, если есть релевантные RealObj - если задан, то код реального объекта, относительно которого необходимо подсчитать кол-во. В этом случае виртуалная структура текущего отображения не учитывается!!! 

• method zNumPr** (qqpar1 As ****, qqpar2 As ****)** returns  

Число qqpar1 прописью. Если задан qqpar2, то имена для целои и дробной части через пробел. По умолчанию - руб. коп. 

• method zRcvt **(Arg1 As ****, Arg2 As ****)** returns nothing. 

Преобразование регистра только для русских букв Arg2="U" - в большие, "L" - в маленькие 

• method zRep** (Arg1 As ****)** returns nothing. 

Убрать повторяющиеся слова в Arg1 

• method zReplace** (String As ****, From As ****, To As **** = "", ReplSeries As ****, DelEnds As ****)** returns  

Метод заменяет в строке String подстроку From на подстроку To. По умолчанию To="", т.е. подстроки From удаляются из String. ReplSeries=1 - заменять последовательность подстрок From (серия) на одну подстроку To. DelEnds=1 - удалять подстроку From (или последовательность подстрок From при ReplSeries=1), находящую в начале или конце исходной строки String. Например, >S a=";;ПЕРВЫЙ;;ВТОРОЙ;ТРЕТИЙ;;;" >W qUSER.zReplace(a,";",";",1,1) >"ПЕРВЫЙ;ВТОРОЙ;ТРЕТИЙ" 

• method zSum **(Obj As ****, qqw As ****, Rel As **** = 0, RealObj As ****)** returns  

Сумма понятия для объекта, подчиненного текущему. Rel=1 учет режима уточнения, если есть релевантные RealObj - если задан, то код реального объекта, относительно которого необходимо подсчитать сумму. !!! В этом случае виртуалная структура текущего отображения не учитывается!!! 

• method zTLine** (mas As ****)** returns nothing. 

Свертка текста в строку. mas - ссылка на массив строк Возвращает строку с убранными переносами 

• method zTmp**(MainObj As ****, ObjList As ****, Ini As ****, Arg1 As ****, Arg2 As ****, Arg3 As ****)** returns nothing. 

УЖЕ НЕ ИСПОЛЬЗУЕТСЯ Вычисляет для текущего экземпляра объекта условие темпоральной коррекции. MainObj - код объекта (главного). ObjList - список (через пробел) вида qqo0:qqo1:qqwqqo1 Ini - вариант использования Параметры инициализации: Arg1=1 - не учитывать дату закрытия (факт закрытия) при подборе общих сведений Arg2=1 - не записывать привязку (YT) для документа, если ничего не изменилось а ее раньше не было. 

• method zTmpI** (in As ****, date As ****, Xd As ****)** returns nothing. 

Проверка даты date (не задана - берется из W("Zdatenow"), если нет - текуая) in=0 - Не совпадает в пределах дня с датой создания (Xc) in=1 - попадает в интервал от Xc до Xd (если параметр Xd не задан, берется из понятия Xd) Возвращает 1 или 0. 

• method zTraspisan** (Arg1 As ****, Arg2 As ****, Arg3 As ****, Arg4 As ****)** returns nothing. 

Преобразование текстового понятия описания расписания (Arg1, по умолчанию "Traspisan") в понятие W("Y"_$E(Arg1,2,255),Arg4) и обратно (Arg2=1) Если задан Arg3 - то это qqnump окна, в котором находится W(Arg1) Arg4 - для хранения истории изменения расписания 

• method zZod **(qqpar1 As ****, qqpar2 As ****)** returns  

Расчет знака зодиака по нормализованной дате (qqpar1) qqpar2 - язык (1 - русский) 

• method zaddm** (BaseDate As ****, addmm As ****, SetDay As ****)** returns nothing. 

Добавление целого числа месяцев к базовой дате Параметры: BaseDate - базовая дата addmm - количество месяцев, добавляем к базовой дата, м.б. отрицательное число SetDay - установаить определённый день в месяце 1 - первый 2 - последний Возвращаемое значение: дата в формате yyyymmdd Если $G(BaseDate)="", то в качестве базовой берётся текущая дата 

• method zsymbol **(str As ****)** returns  

Убрать в строке все символы, кроме цифр и букв 
